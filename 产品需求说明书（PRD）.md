# 佳食宜选 - 餐饮下单系统产品需求说明书（PRD）
**文档版本**：1.0
**生成日期**：2025-11-21
**参考文件**：《佳食宜选.md》《佳食宜选技术实现指导.md》《页面设计文件》《原PRD更新内容》

---

## 一、引言

### 1.1 项目背景
当前餐饮行业进入个性化服务升级阶段，用户对饮食推荐精准度、订单流程便捷性及社交互动协同性提出更高要求。然而市场现存产品普遍存在推荐同质化严重、订单管理流程繁琐、用户与商家协同效率低下等问题。为此，亟需开发一款整合个性化推荐、全链路订单管理、双角色协同及社交互动功能的餐饮系统。

### 1.2 产品目标
1. 为用户提供场景化个性化饮食推荐，降低饮食决策成本，实现卡路里精准管控；
2. 覆盖“选菜-定制-支付-追踪-评价”全订单链路，满足用户个性化需求与操作可追溯性；
3. 明确用户与商家双角色权责边界，实现订单流程透明化与高效协同；
4. 整合外部内容资源与社交互动功能，提升用户粘性与商家运营灵活性。

### 1.3 范围定义
- **包含功能**：个性化饮食推荐、卡路里管理、菜品定制、订单全流程追踪、双角色权限管理、社交聊天与订单协同、AI菜品识别与食谱上传、用户共创与商家运营工具等；
- **排除功能**：线下门店收银系统、供应链仓储管理、第三方配送调度（仅集成配送状态查询）。

---

## 二、功能需求

### 2.1 个性化饮食推荐与日常管理模块
#### 2.1.1 定位与天气智能推荐
- 支持GPS自动定位（定位误差超过500米时弹窗提示用户确认）及手动选择城市/商圈；
- 推荐逻辑融合天气与时间双维度：天气维度（温度＞30℃优先推荐冰饮/凉菜，湿度＞80%推荐祛湿粥品），时间维度（早餐侧重热饮+碳水组合，夜宵主推轻食类）；
- 提供“关闭天气推荐”开关，关闭后切换为“地理位置+历史偏好”纯个性化推荐模式；
- 记录用户推荐拒绝行为（累计3次拒绝某类菜品推荐），后续自动降低同类推荐权重。

#### 2.1.2 卡路里精准管理与饮食趋势
- 用户首次注册时引导填写身高、体重、饮食目标等身体数据，系统自动计算每日卡路里建议摄入量（精确到克级）；
- 选菜过程中实时展示当日剩余可摄入卡路里，点击菜品可查看食材级卡路里明细；
- 自动生成周/月卡路里摄入趋势图，明确标注“超标日”及当日对应菜品。

#### 2.1.3 日历场景化饮食推荐
- 结合节气/节日自动推送特色菜品（立秋推荐“贴秋膘套餐”，端午主推粽子相关搭配）；

### 2.2 全链路订单管理模块
#### 2.2.1 订单流程
- **用户端**：菜品选择→定制要求→订单提交→支付→订单追踪→评价；
- **商家端**：订单接收→备菜→烹饪→完成→评价回复；
- 订单状态定义：0-待支付、1-待接单、2-备菜中、3-烹饪中、4-待上菜、5-已完成、6-已取消。

#### 2.2.2 订单支付
- 支持平台币、微信/支付宝支付；
- 支付页面需分离已支付/未支付订单（已实现，见《用户端页面/群订单支付页面设计.md》）。

### 2.3 双角色权限管理模块
#### 2.3.1 用户端功能
- 个人中心（见《用户端页面/用户中心页面设计.md》）；
- 地址管理（见《用户端页面/管理地址页面设计.md》）；
- 订单管理（见《用户端页面/查看所有订单页面设计.md》）；
- AI聊天助手（见《用户端页面/AI聊天助手页面设计.md》）。

#### 2.3.2 商家端功能
- 商家中心（合并今日订单+订单中心，见《商家端页面/商家中心页面设计.md》）；
- 菜单管理（含状态设置/自动上下架，见《商家端页面/菜单管理页面设计.md》）；
- 菜品管理（见《商家端页面/菜品管理页面设计.md》）；
- 营业统计（见《商家端页面/营业统计页面设计.md》）。

### 2.4 社交互动与订单协同模块
#### 2.4.1 单聊功能
- 商家视角与客户的单聊界面，关联订单信息（见《商家端页面/商家单聊页面设计.md》）；

#### 2.4.2 群聊与群订单功能
- **商家不入群原则**：商家不得直接加入群聊，采用「群发起者与商家创建群订单专属会话」模式；
- **群订单专属会话机制**：群订单首次提交并被商家接单后系统自动创建会话；
- **一键同步功能**：商家发送消息后可选择同步至群聊，同步内容以「【订单同步】」开头；
- **群聊会话详情**：见《商家端页面/商家群聊会话详情页面设计.md》。

### 2.5 AI能力集成模块
- **AI菜品识别**：支持从视频/文章中提取菜品信息、制作步骤、难度等级等；
- **AI食谱上传**：用户可上传食谱并由AI优化（见《佳食宜选技术实现指导.md》第2.4节）。

---

## 三、非功能需求

### 3.1 性能需求
- 接口响应时间：定位≤1秒，天气≤2秒，推荐接口≤3秒；
- 并发处理：支持1000+同时在线用户；
- 数据库性能：订单表查询时间≤500ms，索引覆盖核心查询场景。

### 3.2 安全需求
- **数据加密**：用户支付信息、身份证号等敏感数据MySQL存储时采用AES加密；
- **接口安全**：所有前端请求必须携带JWT令牌，核心接口实现限流与幂等防护；
- **消息加密**：聊天消息、订单数据传输采用HTTPS加密。

### 3.3 可用性需求
- 系统稳定性：99.5%以上的服务可用时间；
- 故障恢复：系统故障后30分钟内恢复；
- 降级策略：第三方接口调用失败时降级使用本地缓存数据。

---

## 四、系统接口需求

### 4.1 第三方接口
- **定位接口**：调用第三方定位服务，支持自动定位与手动选择；
- **天气接口**：获取实时天气数据（温度、湿度等）；
- **支付接口**：集成微信/支付宝支付接口；
- **AI接口**：百度OCR、阿里云NLP等AI服务接口。

### 4.2 内部接口
- **前后端接口**：采用RESTful风格，请求/响应格式为JSON，统一返回格式为"code+message+data"；
- **服务间接口**：Netty长连接接口用于消息实时推送，Redis发布/订阅用于群聊消息同步。

---

## 五、技术实现要求
### 5.1 技术栈
- **后端**：SpringBoot+MyBatis-Plus+MySQL+Redis+Netty；
- **前端**：桌面端（Electron+Vue3）、小程序端（UniApp）。

### 5.2 核心技术实现
- **个性化推荐**：基于Redis缓存的轻量推荐引擎，按"天气适配度×偏好权重×菜品热度"计算；
- **订单同步**：采用Netty+Redis实现实时消息推送，消息失败时重试2次，仍失败则定时补偿；
- **缓存策略**：热点数据（菜品、商家信息）Redis缓存12小时，更新时采用"更新数据库+删除缓存"策略。

---

## 六、运营与维护需求
- **部署方案**：后端采用Docker容器化部署，Nginx负载均衡；Redis采用1主2从，MySQL主从复制；
- **监控与日志**：SpringBoot Actuator基础监控，SLF4J+Logback日志系统；
- **版本迭代**：采用敏捷开发模式，2周/迭代，每次迭代包含功能开发、测试与文档更新。

---

## 七、附则
- 本PRD由产品团队、技术团队共同制定，如有变更需双方签字确认；
- 本PRD的最终解释权归产品团队所有；
- 文档版本更新记录将同步至项目管理系统。

> （注：文档整合了《佳食宜选.md》的需求框架、《佳食宜选技术实现指导.md》的技术约束以及原PRD的群订单模块更新内容，并关联了已完成的所有页面设计文件。）
